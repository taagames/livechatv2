<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>Live Chat Admin Dashboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <h1>üîí Admin Login</h1>
            <p>Enter your admin password to access the live chat dashboard</p>
            <form id="loginForm">
                <input type="password" id="passwordInput" placeholder="Enter admin password" required>
                <button type="submit">Login</button>
            </form>
            <div id="loginError" class="error-message"></div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="admin-dashboard" style="display: none;">
        <header class="dashboard-header">
            <div class="header-left">
                <h1>üí¨ Live Chat Dashboard</h1>
                <div class="stats">
                    <span id="totalChats" class="stat">0 Chats</span>
                    <span id="activeChats" class="stat">0 Active</span>
                    <span id="pendingChats" class="stat">0 Pending</span>
                </div>
            </div>
            <div class="header-controls">
                <div class="control-buttons">
                    <button id="toggleLiveChatBtn" class="control-btn live-chat-btn" title="Toggle Live Chat">
                        <span class="btn-icon">üí¨</span>
                        <span class="btn-text">Enable Live Chat</span>
                    </button>
                    <button id="toggleAIChatbotBtn" class="control-btn ai-btn" title="Toggle AI Chatbot">
                        <span class="btn-icon">ü§ñ</span>
                        <span class="btn-text">Enable AI Chatbot</span>
                    </button>
                    <button id="settingsBtn" class="control-btn settings-btn" title="Settings">
                        <span class="btn-icon">‚öôÔ∏è</span>
                        <span class="btn-text">Settings</span>
                    </button>
                    <button id="refreshChatsBtn" class="control-btn refresh-btn" title="Refresh Chats">
                        <span class="btn-icon">üîÑ</span>
                    </button>
                </div>
                <button id="logoutBtn" class="logout-btn">Logout</button>
            </div>
        </header>

        <div class="dashboard-content">
            <div class="chat-list-panel">
                <div class="panel-header">
                    <h2>Active Chats</h2>
                    <div class="filter-buttons">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="pending">Pending</button>
                        <button class="filter-btn" data-filter="active">Active</button>
                        <button id="blockedUsersBtn" class="filter-btn blocked-users">Blocked Users</button>
                    </div>
                </div>
                <div id="chatList" class="chat-list">
                    <div class="empty-state">
                        <div class="empty-icon">üí¨</div>
                        <h3>No active chats</h3>
                        <p>New conversations will appear here automatically</p>
                    </div>
                </div>
            </div>

            <div class="chat-detail-panel">
                <div id="noChatSelected" class="no-chat-selected">
                    <div class="no-chat-icon">üëà</div>
                    <h3>Select a chat</h3>
                    <p>Choose a conversation from the left to start responding to customers</p>
                </div>

                <div id="chatDetail" class="chat-detail" style="display: none;">
                    <div class="chat-detail-header">
                        <div class="customer-info">
                            <div class="customer-name-container">
                                <h3 id="customerName" class="editable-name">Customer</h3>
                                <button id="editNameBtn" class="edit-btn" title="Edit chat name">‚úèÔ∏è</button>
                            </div>
                            <span id="chatStatus" class="chat-status">Active</span>
                        </div>
                        <div class="chat-actions">
                            <button id="takeChatBtn" class="action-btn take-chat">Take Chat</button>
                            <button id="switchToAIBtn" class="action-btn switch-ai" style="display: none;">Switch to AI</button>
                            <button id="blockUserBtn" class="action-btn block-user">Block User</button>
                            <button id="endChatBtn" class="action-btn end-chat">End Chat</button>
                        </div>
                    </div>

                    <div class="chat-messages-container">
                        <div id="chatMessages" class="chat-messages">
                        </div>
                    </div>

                    <div class="admin-input-container">
                        <div class="input-wrapper">
                            <textarea id="adminMessageInput" placeholder="Type your response to the customer..." rows="3"></textarea>
                            <button id="sendAdminMessage" class="send-btn">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M2.01 21L23 12L2.01 3L2 10L17 12L2 14L2.01 21Z" fill="white"/>
                                </svg>
                                Send
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="settings-modal" style="display: none;">
        <div class="settings-content">
            <div class="settings-header">
                <h2>‚öôÔ∏è Admin Settings</h2>
                <button id="closeSettingsBtn" class="close-settings-btn">√ó</button>
            </div>
            
            <div class="settings-body">
                <div class="setting-group">
                    <h3>üë§ Display Name</h3>
                    <p>This name will appear when you send messages to customers</p>
                    <input type="text" id="adminNameInput" placeholder="Enter your display name" maxlength="50">
                    <button id="saveNameBtn" class="save-btn">Save Name</button>
                </div>
                
                <div class="setting-group">
                    <h3>üé≠ Chat Display</h3>
                    <p>Control how names appear in chat messages</p>
                    <label class="setting-toggle">
                        <input type="checkbox" id="showChatNamesToggle">
                        <span class="toggle-slider"></span>
                        <span class="toggle-label">Show chat names (customers see admin names and "AI Agent")</span>
                    </label>
                </div>

                <div class="setting-group">
                    <h3>üí¨ Chat Suggestions</h3>
                    <p>Quick message options shown to new customers</p>
                    <div id="suggestionsList" class="suggestions-list"></div>
                    <div class="add-suggestion">
                        <input type="text" id="newSuggestionInput" placeholder="Add new suggestion..." maxlength="100">
                        <button id="addSuggestionBtn" class="add-btn">Add</button>
                    </div>
                </div>

                <div class="setting-group">
                    <h3>üé® Theme Customization</h3>
                    <p>Customize the color theme and font for both admin and client chat interfaces</p>
                    
                    <div class="theme-section">
                        <label class="theme-label">Primary Color</label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="primaryColorPicker" value="#007bff">
                            <input type="text" id="primaryColorInput" value="#007bff" placeholder="#007bff" maxlength="7">
                        </div>
                    </div>

                    <div class="theme-section">
                        <label class="theme-label">Secondary Color (for gradients)</label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="secondaryColorPicker" value="#0056b3">
                            <input type="text" id="secondaryColorInput" value="#0056b3" placeholder="#0056b3" maxlength="7">
                        </div>
                    </div>

                    <div class="theme-section">
                        <label class="theme-label">
                            <input type="checkbox" id="useGradientToggle" checked>
                            Use Gradient Theme
                        </label>
                    </div>

                    <div class="theme-section">
                        <label class="theme-label">Font Family</label>
                        <select id="fontFamilySelect">
                            <option value="-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif">Default (System)</option>
                            <option value="'Arial', sans-serif">Arial</option>
                            <option value="'Helvetica Neue', Helvetica, sans-serif">Helvetica</option>
                            <option value="'Georgia', serif">Georgia</option>
                            <option value="'Times New Roman', Times, serif">Times New Roman</option>
                            <option value="'Courier New', Courier, monospace">Courier New</option>
                            <option value="'Verdana', sans-serif">Verdana</option>
                            <option value="'Trebuchet MS', sans-serif">Trebuchet MS</option>
                            <option value="'Comic Sans MS', cursive">Comic Sans MS</option>
                            <option value="'Impact', sans-serif">Impact</option>
                        </select>
                    </div>

                    <div class="theme-preview">
                        <h4>Preview</h4>
                        <div class="preview-bubble" id="previewBubble">Chat Bubble</div>
                        <div class="preview-message" id="previewMessage">Message Preview</div>
                    </div>

                    <button id="saveThemeBtn" class="save-btn">Save Theme</button>
                    <button id="resetThemeBtn" class="reset-btn">Reset to Default</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Block User Modal -->
    <div id="blockUserModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Block User</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to block this user? They will no longer be able to access live chat.</p>
                <div class="form-group">
                    <label for="blockReason">Reason for blocking (optional):</label>
                    <textarea id="blockReason" placeholder="Enter reason for blocking this user..." rows="3"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelBlock" class="btn-secondary">Cancel</button>
                <button id="confirmBlock" class="btn-danger">Block User</button>
            </div>
        </div>
    </div>

    <!-- Blocked Users Modal -->
    <div id="blockedUsersModal" class="modal" style="display: none;">
        <div class="modal-content large">
            <div class="modal-header">
                <h2>Blocked Users Management</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div id="blockedUsersList" class="blocked-users-list">
                    <div class="empty-state">
                        <p>No blocked users found.</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="closeBlockedUsers" class="btn-secondary">Close</button>
            </div>
        </div>
    </div>

    <!-- Notification Sound -->
    <audio id="notificationSound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmIlBziS2OzNeSsFJXbH8d+QQAoUXbTq5KdVFAlFl9+wk" type="audio/wav">
    </audio>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>
    <script src="script.js"></script>
</body>
</html>